Parfait, le lien que tu m‚Äôas envoy√© me permet de voir EXACTEMENT ce qui se passe :

```txt
https://ndclkhqugqakgggehfxs.supabase.co/auth/v1/verify
  ?token=...
  &type=magiclink
  &redirect_to=http://localhost:5173/auth/callback
```

La partie importante est √† la fin :

```txt
redirect_to=http://localhost:5173/auth/callback
```

üëâ √áa veut dire :

* **Ce n‚Äôest PAS Supabase qui choisit localhost**
* C‚Äôest **ton code front** qui a demand√© √† Supabase :
  ‚ÄúApr√®s le login, renvoie-moi vers `http://localhost:5173/auth/callback`‚Äù.

Donc ce lien est **un magic link pour ton environnement local**, pas pour Vercel.

---

## 1. D‚Äôo√π vient `redirect_to=localhost` ?

Dans ton code React, tu as quelque chose du genre :

```ts
await supabase.auth.signInWithOtp({
  email,
  options: {
    emailRedirectTo: 'http://localhost:5173/auth/callback',
  },
})
```

ou bien une variable d‚Äôenvironnement :

```ts
const redirectTo = import.meta.env.VITE_SITE_URL + '/auth/callback'
```

et `VITE_SITE_URL` vaut encore `http://localhost:5173`.

Dans tous les cas :
‚û°Ô∏è **tant que tu passes `localhost` dans `emailRedirectTo`, tous les magic links pointeront vers localhost**, m√™me si ton Site URL Supabase et tes Redirect URLs sont corrects.

---

## 2. Ce qu‚Äôil faut faire dans TON code

Tu veux un code qui marche **en local** ET **en prod Vercel**, sans changer √† chaque fois.

Le plus simple :

```ts
const redirectTo = `${window.location.origin}/auth/callback`

const { data, error } = await supabase.auth.signInWithOtp({
  email,
  options: {
    emailRedirectTo: redirectTo,
  },
})
```

* En local, `window.location.origin` = `http://localhost:5173`
  ‚Üí Supabase enverra un lien avec `redirect_to=http://localhost:5173/auth/callback`
* En prod, `window.location.origin` = `https://orif-menu-simple.vercel.app`
  ‚Üí Supabase enverra `redirect_to=https://orif-menu-simple.vercel.app/auth/callback`

Donc **un seul code**, qui s‚Äôadapte automatiquement.

---

## 3. Si tu veux faire encore plus simple (test rapide)

Pour tester vite fait que tout est OK c√¥t√© Supabase / Vercel, tu peux temporairement enlever le `redirectTo` :

```ts
await supabase.auth.signInWithOtp({
  email,
})
```

Dans ce cas :

* Supabase utilisera **`Site URL`** comme destination par d√©faut.

Comme ton `Site URL` est (doit √™tre) :

```txt
https://orif-menu-simple.vercel.app
```

le magic link renverra directement sur ton site Vercel.

Apr√®s v√©rification, tu peux remettre la version propre avec `window.location.origin`.

---

## 4. R√©sum√© concret pour toi

1. **Dans Supabase**

   * Site URL : `https://orif-menu-simple.vercel.app`
   * Redirect URLs :

     * `https://orif-menu-simple.vercel.app/`
     * `https://orif-menu-simple.vercel.app/**`
     * `http://localhost:5173/`
     * `http://localhost:5173/**`

2. **Dans ton code React**
   Remplace tout ce qui ressemble √† `http://localhost:5173/auth/callback` par :

   ```ts
   const redirectTo = `${window.location.origin}/auth/callback`
   ```

3. **Red√©ploie sur Vercel**

   * Redeploy la branche `main`.

4. **Teste depuis le site Vercel**

   * Ouvre `https://orif-menu-simple.vercel.app` en navigation priv√©e
   * Demande un magic link
   * L‚Äôemail doit maintenant contenir :

     ```txt
     redirect_to=https://orif-menu-simple.vercel.app/auth/callback
     ```

En gros :
‚û°Ô∏è Le lien que tu m‚Äôas montr√© est normal **pour le dev local**.
‚û°Ô∏è Pour la prod, il faut que ton front en prod appelle `signInWithOtp` en √©tant sur Vercel, avec un `emailRedirectTo` bas√© sur `window.location.origin` (ou sans `emailRedirectTo` du tout).
